{"version":3,"file":"format.js","sources":["../src/utils/format.js"],"sourcesContent":["import JSBI from 'jsbi'\nimport { NO_BREAK_SPACE } from './characters'\nimport { divideRoundBigInt } from './math'\n\n/**\n * Formats an integer based on a limited range.\n *\n * Example:\n *   formatIntegerRange(234, 0, 99, '+') === \"99+\"\n *\n * @param {number} value     The number to format.\n * @param {number} min       Range minimum.\n * @param {number} max       Range maximum.\n * @param {number} maxSuffix Suffix to add if the value exceeds the max.\n */\nexport function formatIntegerRange(\n  value = -1,\n  min = 0,\n  max = 99,\n  maxSuffix = ''\n) {\n  value = parseInt(value, 10)\n  if (value <= min) {\n    return `${parseInt(min, 10)}`\n  }\n  if (value > max) {\n    return `${parseInt(max, 10)}${maxSuffix}`\n  }\n  return String(value)\n}\n\n/**\n * Formats a number for display purposes.\n *\n * This function is not using Intl.NumberFormat() to be compatible with big\n * integers expressed as string, or BigInt-like objects.\n *\n * @param {BigInt|string|number} number Number to convert\n * @returns {string}\n */\nexport function formatNumber(number) {\n  const numAsString = String(number)\n  const [integer, decimals] = numAsString.split('.')\n\n  return [...integer].reverse().reduce(\n    (result, digit, index) => {\n      return digit + (index > 0 && index % 3 === 0 ? ',' : '') + result\n    },\n    decimals ? `.${decimals}` : ''\n  )\n}\n\n/**\n * Formats a token amount for display purposes.\n *\n * @param {BigInt|string|number} amount              Number to round\n * @param {BigInt|string|number} decimals            Decimal placement for amount\n * @param {BigInt|string|number} digits              Rounds the number to a given decimal place\n * @param {boolean}              options.displaySign Decides if the sign should be displayed\n * @param {string}               options.symbol      Symbol for the token amount\n * @returns {string}\n */\nexport function formatTokenAmount(\n  amount,\n  decimals,\n  { digits = 2, symbol = '', displaySign = false } = {}\n) {\n  amount = JSBI.BigInt(String(amount))\n  decimals = JSBI.BigInt(String(decimals))\n  digits = JSBI.BigInt(String(digits))\n\n  const _0 = JSBI.BigInt(0)\n  const _10 = JSBI.BigInt(10)\n\n  if (JSBI.lessThan(decimals, _0)) {\n    throw new Error('formatTokenAmount(): decimals cannot be negative')\n  }\n\n  if (JSBI.lessThan(digits, _0)) {\n    throw new Error('formatTokenAmount(): digits cannot be negative')\n  }\n\n  if (JSBI.lessThan(decimals, digits)) {\n    digits = decimals\n  }\n\n  const negative = JSBI.lessThan(amount, _0)\n\n  if (negative) {\n    amount = JSBI.unaryMinus(amount)\n  }\n\n  const amountConverted = JSBI.equal(decimals, _0)\n    ? amount\n    : JSBI.BigInt(\n        divideRoundBigInt(\n          amount,\n          JSBI.exponentiate(_10, JSBI.subtract(decimals, digits))\n        )\n      )\n\n  const leftPart = formatNumber(\n    JSBI.divide(amountConverted, JSBI.exponentiate(_10, digits))\n  )\n\n  const rightPart = String(\n    JSBI.remainder(amountConverted, JSBI.exponentiate(_10, digits))\n  )\n    .padStart(digits, '0')\n    .replace(/0+$/, '')\n\n  return [\n    displaySign ? (negative ? '-' : '+') : '',\n    leftPart,\n    rightPart ? `.${rightPart}` : '',\n    symbol ? `${NO_BREAK_SPACE}${symbol}` : '',\n  ].join('')\n}\n"],"names":["formatIntegerRange","value","min","max","maxSuffix","parseInt","String","formatNumber","number","numAsString","integer","decimals","split","reverse","reduce","result","digit","index","formatTokenAmount","amount","digits","symbol","displaySign","JSBI","BigInt","_0","_10","lessThan","Error","negative","unaryMinus","amountConverted","equal","divideRoundBigInt","exponentiate","subtract","leftPart","divide","rightPart","remainder","padStart","replace","NO_BREAK_SPACE","join"],"mappings":"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"}