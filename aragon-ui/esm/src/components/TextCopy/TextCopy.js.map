{"version":3,"file":"TextCopy.js","sources":["../../../../../src/components/TextCopy/TextCopy.js"],"sourcesContent":["import React, { useCallback, useImperativeHandle, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport { IconCopy } from '../../icons/'\nimport { GU, RADIUS, textStyle } from '../../style'\nimport { useTheme } from '../../theme'\nimport { noop, warn } from '../../utils'\nimport TextInput from '../Input/TextInput'\nimport ButtonIcon from '../Button/ButtonIcon'\nimport { useToast } from '../ToastHub/ToastHub'\n\nconst HEIGHT = 5 * GU\n\nconst TextCopy = React.memo(\n  React.forwardRef(function TextCopy(\n    { adornment, autofocus, message, monospace, onCopy, value, ...props },\n    ref\n  ) {\n    const theme = useTheme()\n    const toast = useToast()\n    const inputRef = useRef(null)\n\n    // Allows to focus the component from the outside\n    useImperativeHandle(ref, () => ({\n      focus: () => {\n        inputRef.current.focus()\n      },\n    }))\n\n    // Select the content on focus\n    const handleFocus = useCallback(() => {\n      inputRef.current && inputRef.current.select()\n    }, [])\n\n    // If onCopy is set (either to a function or null), Toast is not used.\n    const onCopyOrToast = onCopy === undefined ? toast : onCopy || noop\n\n    const handleCopy = useCallback(() => {\n      if (inputRef.current) {\n        inputRef.current.focus()\n\n        try {\n          document.execCommand('copy')\n          onCopyOrToast(message)\n        } catch (err) {\n          warn(err)\n        }\n      }\n    }, [message, onCopyOrToast])\n\n    return (\n      <div\n        css={`\n          position: relative;\n          display: inline-flex;\n          width: ${52.5 * GU}px;\n          max-width: 100%;\n          height: ${HEIGHT}px;\n          padding-left: ${adornment ? `${HEIGHT}px` : '0'};\n        `}\n        {...props}\n      >\n        {adornment && (\n          <div\n            css={`\n              position: absolute;\n              top: 0;\n              left: 0;\n              overflow: hidden;\n              width: ${HEIGHT}px;\n              height: ${HEIGHT}px;\n              background: ${theme.surface};\n              border: 1px solid ${theme.border};\n              border-right: 0;\n\n              // 0.0001px fixes an issue on Blink browsers, where each\n              // border-radius need to be non 0 for overflow:hidden to work.\n              border-radius: ${RADIUS}px 0.0001px 0.0001px ${RADIUS}px;\n            `}\n          >\n            <div\n              css={`\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                width: ${HEIGHT - 2}px;\n                height: ${HEIGHT - 2}px;\n              `}\n            >\n              {adornment}\n            </div>\n          </div>\n        )}\n        <TextInput\n          ref={inputRef}\n          adornment={\n            <ButtonIcon\n              onClick={handleCopy}\n              label=\"Copy\"\n              css={`\n                width: ${HEIGHT - 2}px;\n                height: ${HEIGHT - 2}px;\n                border-radius: 0;\n                color: ${theme.surfaceIcon};\n              `}\n            >\n              <IconCopy />\n            </ButtonIcon>\n          }\n          adornmentPosition=\"end\"\n          adornmentSettings={{\n            // Keep the button square\n            width: HEIGHT - 2,\n            padding: 0,\n          }}\n          autofocus={autofocus}\n          onFocus={handleFocus}\n          readOnly\n          value={value}\n          wide\n          css={`\n            text-overflow: ellipsis;\n            height: ${HEIGHT}px;\n            max-width: 100%;\n            border: 1px solid ${theme.border};\n            border-radius: ${RADIUS}px;\n            ${adornment\n              ? `\n                  border-top-left-radius: 0;\n                  border-bottom-left-radius: 0;\n                  border-left: 0;\n                `\n              : ''};\n            ${textStyle(monospace ? 'address2' : 'body3')};\n            &:read-only {\n              color: ${theme.surfaceContent};\n              text-shadow: none;\n            }\n          `}\n        />\n      </div>\n    )\n  })\n)\n\nTextCopy.propTypes = {\n  adornment: PropTypes.node,\n  autofocus: PropTypes.bool,\n  message: PropTypes.string,\n  monospace: PropTypes.bool,\n  onCopy: PropTypes.func,\n  value: PropTypes.string,\n}\n\nTextCopy.defaultProps = {\n  autofocus: false,\n  message: 'Copied',\n  monospace: true,\n}\n\nexport default TextCopy\n"],"names":["HEIGHT","GU","TextCopy","React","memo","forwardRef","ref","adornment","autofocus","message","monospace","onCopy","value","props","theme","useTheme","toast","useToast","inputRef","useRef","useImperativeHandle","focus","current","handleFocus","useCallback","select","onCopyOrToast","undefined","noop","handleCopy","document","execCommand","err","warn","surface","border","surfaceIcon","width","padding","textStyle","surfaceContent","propTypes","PropTypes","node","bool","string","func","defaultProps","RADIUS"],"mappings":"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"}