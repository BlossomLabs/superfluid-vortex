{"version":3,"file":"TabsFullWidth.js","sources":["../../../../../src/components/Tabs/TabsFullWidth.js"],"sourcesContent":["import React, { useCallback, useRef, useState } from 'react'\nimport { Transition, animated } from '@react-spring/web'\nimport { useInside } from 'use-inside'\nimport { GU, textStyle, springs } from '../../style'\nimport { useFocusLeave } from '../../hooks'\nimport { IconDown } from '../../icons'\nimport { useTheme } from '../../theme'\nimport { KEY_ESC } from '../../utils'\nimport ButtonBase from '../ButtonBase/ButtonBase'\n\n// TabsFullWidth is an internal component\n/* eslint-disable react/prop-types */\n\nfunction TabsFullWidth({ items, selected, onChange }) {\n  const theme = useTheme()\n  const buttonRef = useRef(null)\n  const [insideSidePanel] = useInside('SidePanel')\n  const [opened, setOpened] = useState(false)\n\n  const selectedItem = items[selected]\n  const dropdownDisabled = items.length === 1\n\n  const close = useCallback(() => setOpened(false), [])\n\n  const focusButton = useCallback(() => {\n    if (buttonRef.current) {\n      buttonRef.current.focus()\n    }\n  }, [])\n\n  const toggle = useCallback(() => {\n    setOpened(opened => !opened)\n  }, [])\n\n  const change = useCallback(\n    index => {\n      close()\n      focusButton()\n      if (index !== selected) {\n        onChange(index)\n      }\n    },\n    [selected, onChange, close, focusButton]\n  )\n\n  const { handleFocusLeave, ref } = useFocusLeave(close)\n\n  // close on escape\n  const handleMenuKeyDown = useCallback(\n    event => {\n      if (event.keyCode === KEY_ESC) {\n        close()\n        focusButton()\n      }\n    },\n    [close, focusButton]\n  )\n\n  return (\n    <div\n      ref={ref}\n      onBlur={handleFocusLeave}\n      css={`\n        padding-bottom: ${2 * GU}px;\n      `}\n    >\n      <div\n        css={`\n          position: relative;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          width: 100%;\n          height: ${8 * GU}px;\n        `}\n      >\n        <ButtonBase\n          ref={buttonRef}\n          disabled={dropdownDisabled}\n          css={`\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            width: 100%;\n            height: 100%;\n            background: ${theme.surface};\n            border-style: solid;\n            border-color: ${theme.border};\n            border-top-width: ${insideSidePanel ? '0' : '1px'};\n            border-bottom-width: 1px;\n            border-radius: 0;\n            ${textStyle('body2')};\n            &:active {\n              ${dropdownDisabled ? '' : `background: ${theme.surfacePressed};`}\n            }\n          `}\n          onClick={toggle}\n        >\n          <div\n            css={`\n              padding-left: ${2 * GU}px;\n            `}\n          >\n            {selectedItem}\n          </div>\n          <div\n            css={`\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              width: ${7 * GU}px;\n              height: 100%;\n              color: ${theme.surfaceIcon};\n            `}\n          >\n            <IconDown\n              css={`\n                transition: transform 150ms ease-in-out;\n                transform: rotate3d(0, 0, 1, ${opened ? 180 : 0}deg);\n                color: ${dropdownDisabled ? theme.disabled : theme.surfaceIcon};\n              `}\n            />\n          </div>\n        </ButtonBase>\n        <Transition\n          items={opened}\n          config={springs.swift}\n          from={{ y: -1, opacity: 0 }}\n          enter={{ y: 0, opacity: 1 }}\n          leave={{ y: -1, opacity: 0 }}\n          native\n        >\n          {({ opacity, y }, show) =>\n            show && (\n              <animated.div\n                css={`\n                  position: absolute;\n                  z-index: 9; // TODO: use <Root>\n                  top: ${8 * GU}px;\n                  left: 0;\n                  right: 0;\n                  border-bottom: 1px solid ${theme.border};\n                  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.05);\n                  background: ${theme.surface};\n                `}\n                style={{\n                  opacity: opacity,\n                  transform: y.to(v => `translate3d(0, ${v * 4}px, 0)`),\n                }}\n              >\n                <Menu\n                  items={items}\n                  onChange={change}\n                  onKeyDown={handleMenuKeyDown}\n                />\n              </animated.div>\n            )\n          }\n        </Transition>\n      </div>\n    </div>\n  )\n}\n\nfunction Menu({ items, onChange, ...props }) {\n  const handleRef = useCallback(element => {\n    if (element) {\n      element.focus()\n    }\n  }, [])\n\n  return (\n    <div\n      ref={handleRef}\n      tabIndex=\"0\"\n      {...props}\n      css={`\n        display: flex;\n        flex-direction: column;\n        outline: 0;\n      `}\n    >\n      {items.map((item, index) => (\n        <MenuItem key={index} item={item} index={index} onChange={onChange} />\n      ))}\n    </div>\n  )\n}\n\nfunction MenuItem({ item, index, onChange }) {\n  const theme = useTheme()\n\n  const change = useCallback(() => {\n    onChange(index)\n  }, [onChange, index])\n\n  return (\n    <ButtonBase\n      onClick={change}\n      css={`\n        height: ${8 * GU}px;\n        padding-left: ${2 * GU}px;\n        text-align: left;\n        ${textStyle('body2')};\n        &:active {\n          background: ${theme.surfacePressed};\n        }\n      `}\n    >\n      {item}\n    </ButtonBase>\n  )\n}\n\nexport { TabsFullWidth }\n"],"names":["TabsFullWidth","items","selected","onChange","theme","useTheme","buttonRef","useRef","insideSidePanel","useInside","opened","setOpened","useState","selectedItem","dropdownDisabled","length","close","useCallback","focusButton","current","focus","toggle","change","index","handleFocusLeave","ref","useFocusLeave","handleMenuKeyDown","event","keyCode","KEY_ESC","React","GU","surface","border","textStyle","surfacePressed","surfaceIcon","disabled","springs","swift","y","opacity","show","transform","to","v","Menu","props","handleRef","element","map","item","MenuItem"],"mappings":"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"}