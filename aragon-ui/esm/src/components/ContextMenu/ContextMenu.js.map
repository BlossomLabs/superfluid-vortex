{"version":3,"file":"ContextMenu.js","sources":["../../../../../src/components/ContextMenu/ContextMenu.js"],"sourcesContent":["import React, { useState, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\nimport { Spring, animated } from '@react-spring/web'\nimport ClickOutHandler from 'react-onclickout'\nimport { useTheme } from '../../theme'\nimport { springs, RADIUS } from '../../style'\nimport { IconEllipsis, IconDown } from '../../icons/components'\nimport ButtonBase from '../ButtonBase/ButtonBase'\n\nconst BASE_WIDTH = 46\nconst BASE_HEIGHT = 32\n\nfunction ContextMenu({ children, zIndex, disabled }) {\n  const theme = useTheme()\n  const [opened, setOpened] = useState(false)\n\n  const handleClose = useCallback(() => {\n    setOpened(false)\n  }, [])\n\n  const handleBaseButtonClick = useCallback(() => {\n    setOpened(opened => !opened)\n  }, [])\n\n  // Increase the z-index on an opened menu, to make sure it's above any other\n  // context menus below it using the same z-index (e.g. when used in a list)\n  const appliedZIndex = opened ? zIndex + 1 : zIndex\n\n  return (\n    <ClickOutHandler onClickOut={handleClose}>\n      <Spring\n        config={springs.smooth}\n        to={{ openProgress: Number(opened) }}\n        native\n      >\n        {({ openProgress }) => (\n          <Main\n            css={`\n              z-index: ${appliedZIndex};\n            `}\n            style={{\n              boxShadow: openProgress.to(\n                t => `0 4px 4px rgba(0, 0, 0, ${t * 0.03})`\n              ),\n            }}\n          >\n            <Button\n              onClick={handleBaseButtonClick}\n              opened={opened}\n              disabled={disabled}\n              focusRingRadius={RADIUS}\n              css={`\n                color: ${disabled\n                  ? theme.disabledContent\n                  : opened\n                  ? theme.accent\n                  : theme.surfaceContent};\n                background: ${disabled ? theme.disabled : theme.surface};\n                border: ${disabled ? '0' : `1px solid ${theme.border}`};\n                border-bottom-color: ${opened ? theme.surface : theme.border};\n                ${disabled\n                  ? ''\n                  : `&:active {\n                  background: ${theme.surfacePressed};\n                  border-bottom-color: ${\n                    opened ? theme.surfacePressed : theme.border\n                  };\n                }`}\n              `}\n            >\n              <IconEllipsis css={``} />\n              <animated.div\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  transformOrigin: '50% 50%',\n                  transform: openProgress.to(v => `rotate(${v * 180}deg)`),\n                }}\n              >\n                <IconDown\n                  size=\"tiny\"\n                  css={`\n                    color: ${disabled ? theme.disabledIcon : theme.surfaceIcon};\n                  `}\n                />\n              </animated.div>\n            </Button>\n            {opened && (\n              <React.Fragment>\n                <animated.div\n                  onClick={handleClose}\n                  style={{\n                    opacity: openProgress,\n                    boxShadow: openProgress.to(\n                      t => `0 4px 4px rgba(0, 0, 0, ${t * 0.03})`\n                    ),\n                  }}\n                  css={`\n                    z-index: ${appliedZIndex + 1};\n                    overflow: hidden;\n                    position: absolute;\n                    top: ${BASE_HEIGHT - 1}px;\n                    right: 0;\n                    background: ${theme.surface};\n                    border: 1px solid ${theme.border};\n                    border-radius: 3px 0 3px 3px;\n                  `}\n                >\n                  {children}\n                </animated.div>\n                <div\n                  css={`\n                    z-index: ${appliedZIndex + 1};\n                    position: absolute;\n                    bottom: 0;\n                    right: 1px;\n                    height: 1px;\n                    width: ${BASE_WIDTH - 2}px;\n                    background: ${theme.surface};\n                  `}\n                />\n              </React.Fragment>\n            )}\n          </Main>\n        )}\n      </Spring>\n    </ClickOutHandler>\n  )\n}\n\nContextMenu.propTypes = {\n  children: PropTypes.node,\n  zIndex: PropTypes.number,\n  disabled: PropTypes.bool,\n}\nContextMenu.defaultProps = {\n  zIndex: 0,\n  disabled: false,\n}\n\nconst Main = styled(animated.div)`\n  position: relative;\n  width: ${BASE_WIDTH}px;\n  height: ${BASE_HEIGHT}px;\n`\n\nconst Button = styled(ButtonBase)`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: ${BASE_HEIGHT}px;\n  border-radius: ${({ opened }) =>\n    opened ? `${RADIUS}px ${RADIUS}px 0 0` : `${RADIUS}px`};\n\n  box-shadow: ${({ disabled }) =>\n    disabled ? 'none' : `0px 1px 3px rgba(0, 0, 0, 0.1)`};\n`\n\nexport default ContextMenu\n"],"names":["BASE_WIDTH","BASE_HEIGHT","ContextMenu","children","zIndex","disabled","theme","useTheme","opened","setOpened","useState","handleClose","useCallback","handleBaseButtonClick","appliedZIndex","React","springs","smooth","openProgress","Number","boxShadow","to","t","RADIUS","disabledContent","accent","surfaceContent","surface","border","surfacePressed","display","alignItems","transformOrigin","transform","v","disabledIcon","surfaceIcon","opacity","propTypes","PropTypes","node","number","bool","defaultProps","Main","styled","animated","div","Button","ButtonBase"],"mappings":"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"}