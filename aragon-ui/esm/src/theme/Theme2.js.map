{"version":3,"file":"Theme2.js","sources":["../../../../src/theme/Theme.js"],"sourcesContent":["import React, { useContext, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { color, warnOnce } from '../utils'\nimport dark from './theme-dark'\nimport light from './theme-light'\n\n// Every theme has a name and an appearance.\n// The appearance can be either “dark” or “light”.\nconst APPEARANCES = ['dark', 'light']\n\nconst EMBEDDED_THEMES = { dark, light }\nconst THEME_DEFAULT = 'light'\n\nconst RESERVED_KEYS = ['_appearance', '_name']\nconst DEPRECATED_COLORS = new Map([\n  ['error', 'negative'],\n  ['success', 'positive'],\n])\n\nconst COLOR_FALLBACK = '#FF00FF'\n\nfunction getTheme(theme) {\n  const validationError = validateTheme(theme)\n  if (validationError !== null) {\n    warnOnce(\n      `theme:theme-invalid:${validationError}`,\n      `Theme invalid: ${validationError}. ` +\n        `Using the theme “${THEME_DEFAULT}” instead.`\n    )\n    return EMBEDDED_THEMES[THEME_DEFAULT]\n  }\n\n  if (typeof theme === 'string' && EMBEDDED_THEMES[theme]) {\n    return EMBEDDED_THEMES[theme]\n  }\n\n  const baseTheme =\n    EMBEDDED_THEMES[theme._appearance === 'dark' ? 'dark' : 'light']\n\n  return { ...baseTheme, ...theme }\n}\n\n// Setting the default is needed for cases when components are used without being wrapped in `<Theme />`, e.g. for tests.\nconst ThemeContext = React.createContext(prepareTheme(getTheme(THEME_DEFAULT)))\n\nfunction convertThemeColor(name, value) {\n  if (RESERVED_KEYS.includes(name)) {\n    return value\n  }\n\n  try {\n    return color(value)\n  } catch (err) {\n    return color(COLOR_FALLBACK)\n  }\n}\n\n// prepareTheme() does a few things:\n// - Wrap every color in a color() object (see utils/color.js).\n// - Filter out invalid colors added in custom themes.\n// - Wraps the theme in a proxy that warns about deprecated colors.\nfunction prepareTheme(theme) {\n  const themeConverted = Object.fromEntries(\n    Object.entries(theme)\n      .filter(([name]) => {\n        if (!EMBEDDED_THEMES[THEME_DEFAULT][name]) {\n          warnOnce(\n            `theme:invalid:${name}`,\n            `Theme: the color “${name}” is invalid and will be ignored. ` +\n              `Please check src/theme/theme-light.js in the aragonUI ` +\n              `repository for a list of valid colors.`\n          )\n          return false\n        }\n        return true\n      })\n      .map(([name, value]) => [name, convertThemeColor(name, value)])\n  )\n  return new Proxy(themeConverted, {\n    get(theme, name) {\n      if (DEPRECATED_COLORS.has(name)) {\n        warnOnce(\n          `theme:deprecated:${name}`,\n          `useTheme(): the color “${name}” has been deprecated and will be removed soon. ` +\n            `Please use “${DEPRECATED_COLORS.get(name)}” instead.`\n        )\n        return theme[DEPRECATED_COLORS.get(name)]\n      }\n      if (!theme[name]) {\n        warnOnce(\n          `theme:unknown:${name}`,\n          `useTheme(): the color “${name}” doesn’t exist in the theme.`\n        )\n        return COLOR_FALLBACK\n      }\n      return theme[name]\n    },\n  })\n}\n\nfunction validateTheme(theme) {\n  if (typeof theme === 'string') {\n    return EMBEDDED_THEMES[theme] ? null : `the theme “${theme}” doesn’t exist`\n  }\n  if (theme && !theme._name) {\n    return `the “_name” key of the theme is missing`\n  }\n  if (theme && !APPEARANCES.includes(theme._appearance)) {\n    return `the “_appearance” key of the theme is missing`\n  }\n  return null\n}\n\nfunction Theme({ theme, children }) {\n  if (theme === undefined) {\n    theme = THEME_DEFAULT\n  }\n\n  const themeConverted = useMemo(() => prepareTheme(getTheme(theme)), [theme])\n\n  return (\n    <ThemeContext.Provider value={themeConverted}>\n      {children}\n    </ThemeContext.Provider>\n  )\n}\n\nTheme.propTypes = {\n  children: PropTypes.node,\n  theme: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n}\n\nfunction useTheme() {\n  return useContext(ThemeContext)\n}\n\nTheme.THEME_DEFAULT = THEME_DEFAULT\nTheme.EMBEDDED_THEMES = EMBEDDED_THEMES\n\nexport { Theme, useTheme }\n"],"names":["APPEARANCES","EMBEDDED_THEMES","dark","light","THEME_DEFAULT","RESERVED_KEYS","DEPRECATED_COLORS","Map","COLOR_FALLBACK","getTheme","theme","validationError","validateTheme","warnOnce","baseTheme","_appearance","ThemeContext","React","createContext","prepareTheme","convertThemeColor","name","value","includes","color","err","themeConverted","Object","fromEntries","entries","filter","map","Proxy","get","has","_name","Theme","children","undefined","useMemo","propTypes","PropTypes","node","oneOfType","object","string","useTheme","useContext"],"mappings":"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"}