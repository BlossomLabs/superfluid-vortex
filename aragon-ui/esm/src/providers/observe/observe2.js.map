{"version":3,"file":"observe2.js","sources":["../../../../../src/providers/observe/observe.js"],"sourcesContent":["import React from 'react'\nimport getDisplayName from 'react-display-name'\nimport { warnOnce } from '../../utils'\n\n// Higher-order component for convenient subscriptions to RxJS observables\nconst observe = (observe, initialState = {}) => Component =>\n  class extends React.Component {\n    static displayName = `Observe(${getDisplayName(Component)})`\n    static propTypes = {\n      observable: ({ observable }, _, componentName) => {\n        if (observable && typeof observable.subscribe !== 'function') {\n          throw new Error(\n            `Invalid prop \\`observable\\` supplied to \\`${componentName}\\` ` +\n              '(wrapped by `observe()`). ' +\n              '`observable` must be an RxJS Observable-like object. ' +\n              `Given ${observable} instead.`\n          )\n        }\n      },\n    }\n    state = initialState\n    componentDidMount() {\n      this.subscribe(this.props.observable)\n    }\n    componentWillReceiveProps({ observable: nextObservable }) {\n      const { observable } = this.props\n      // If a new observable gets passed in, unsubscribe from the old and subscribe to the new\n      if (nextObservable !== observable) {\n        this.unsubscribe()\n        this.subscribe(nextObservable)\n      }\n    }\n    componentWillUnmount() {\n      this.unsubscribe()\n    }\n    subscribe = observable => {\n      if (observable) {\n        this.setState({\n          subscription: observe(observable).subscribe(state => {\n            this.setState(state)\n          }),\n        })\n      }\n    }\n    unsubscribe = () => {\n      this.state.subscription && this.state.subscription.unsubscribe()\n    }\n    render() {\n      warnOnce(\n        'observe()',\n        'observe() is deprecated. If you are using it with @aragon/api, using @aragon/api-react is now recommended instead.'\n      )\n      const { ...props } = this.props\n      // Don't pass down the given observable\n      delete props.observable\n\n      return <Component {...this.state} {...props} />\n    }\n  }\n\nexport default observe\n"],"names":["observe","initialState","Component","React","observable","setState","subscription","subscribe","state","unsubscribe","componentDidMount","props","componentWillReceiveProps","nextObservable","componentWillUnmount","render","warnOnce","getDisplayName","_","componentName","Error"],"mappings":"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"}