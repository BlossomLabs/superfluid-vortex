{"version":3,"file":"date.js","sources":["../../../../src/utils/date.js"],"sourcesContent":["import dayjs from 'dayjs'\n\nconst UNITS = [\n  ['years', 'year'],\n  ['months', 'month'],\n  ['days', 'day'],\n  ['hours', 'hour'],\n  ['minutes', 'minute'],\n  ['seconds', 'second'],\n]\n\nconst DEFAULT_UNITS = ['years', 'months', 'days', 'hours', 'minutes', 'seconds']\n\n// Return the difference between two dates, per unit.\n// Set `units` to get specific units only, e.g. ['minutes', 'seconds']\n// If `units` is not set, all the units are enabled.\nexport const difference = (date1, date2, options = {}) => {\n  const units = options.units || DEFAULT_UNITS\n  const maxUnits = options.maxUnits || -1\n  const keepLeadingZeros =\n    (maxUnits === -1 && options.keepLeadingZeros) || false\n\n  const start = date2 > date1 ? date1 : date2\n\n  const getRightMostUnitIndex = () =>\n    [...UNITS].reverse().find(([unit]) => units.includes(unit))[0]\n\n  return UNITS.reduce(\n    (result, [name, unitName], index) => {\n      result[name] = null\n\n      // fill the current unit, subtract the difference from the remaining\n      if (\n        (maxUnits === -1 || result.remainingUnits > 0) &&\n        units.includes(name)\n      ) {\n        result[name] = result.remaining.diff(start, unitName)\n        result.remaining = result.remaining.subtract(result[name], unitName)\n      }\n\n      // remove leading zeros\n      if (!keepLeadingZeros && !result.seenNonZero) {\n        if (result[name] === 0) {\n          result[name] = null\n        } else {\n          result.seenNonZero = true\n        }\n      }\n\n      // enforce the maxUnits option\n      if (result.remainingUnits > 0 && result.seenNonZero) {\n        result.remainingUnits -= 1\n      }\n\n      // last iteration\n      if (index === UNITS.length - 1) {\n        delete result.remaining\n        delete result.remainingUnits\n        delete result.seenNonZero\n\n        // include at least one 0\n        if (Object.values(result).every(val => val === null)) {\n          result[getRightMostUnitIndex()] = 0\n        }\n      }\n\n      return result\n    },\n    {\n      remaining: dayjs(start === date1 ? date2 : date1),\n      remainingUnits: maxUnits,\n      seenNonZero: false,\n    }\n  )\n}\n\nexport const eachDayOfInterval = ({ start, end } = {}) => {\n  let startDate = dayjs(start)\n  let endDate = dayjs(end)\n\n  if (!startDate.isValid()) {\n    throw new Error('Start date of interval is invalid')\n  }\n  if (!endDate.isValid()) {\n    throw new Error('End date of interval is invalid')\n  }\n\n  startDate = startDate.startOf('day')\n  endDate = endDate.startOf('day')\n\n  if (startDate.isAfter(endDate)) {\n    throw new Error('Start date of interval is after end date')\n  }\n\n  const interval = []\n  while (!startDate.isAfter(endDate)) {\n    interval.push(startDate.toDate())\n    startDate = startDate.add(1, 'day')\n  }\n\n  return interval\n}\n\nexport const formatHtmlDatetime = date => dayjs(date).toISOString()\n"],"names":["UNITS","DEFAULT_UNITS","difference","date1","date2","options","units","maxUnits","keepLeadingZeros","start","getRightMostUnitIndex","reverse","find","unit","includes","reduce","result","index","name","unitName","remainingUnits","remaining","diff","subtract","seenNonZero","length","Object","values","every","val","dayjs","eachDayOfInterval","end","startDate","endDate","isValid","Error","startOf","isAfter","interval","push","toDate","add","formatHtmlDatetime","date","toISOString"],"mappings":"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"}