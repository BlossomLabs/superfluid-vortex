{"version":3,"file":"DateRangePicker.js","sources":["../src/components/DateRangePicker/DateRangePicker.js"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport dayjs from 'dayjs'\nimport Button from '../Button/Button'\nimport { useViewport } from '../../providers/Viewport/Viewport'\nimport { GU, BIG_RADIUS } from '../../style'\nimport { useTheme } from '../../theme'\nimport DatePicker from './DatePicker'\nimport Labels from './Labels'\nimport { START_DATE, END_DATE } from './consts'\nimport { handleDateSelect } from './utils'\nimport Popover from '../Popover/Popover'\n\nfunction DateRangePicker({\n  format,\n  endDate: endDateProp,\n  onChange,\n  startDate: startDateProp,\n}) {\n  const theme = useTheme()\n  const labelsRef = useRef()\n  const [showPicker, setShowPicker] = useState(false)\n  const [startDate, setStartDate] = useState(startDateProp)\n  const [endDate, setEndDate] = useState(endDateProp)\n\n  // on closing the picked, reset state\n  useEffect(() => {\n    if (!showPicker) {\n      setStartDate(startDateProp)\n      setEndDate(endDateProp)\n    }\n  }, [endDateProp, startDateProp, showPicker])\n\n  const handlePopoverClose = useCallback(() => setShowPicker(false), [])\n\n  const handleLabelsClick = useCallback(() => {\n    setShowPicker(show => !show)\n  }, [])\n\n  const handleDateClick = useCallback(\n    date => {\n      const result = handleDateSelect({ date, startDate, endDate })\n      result.startDate !== undefined && setStartDate(result.startDate)\n      result.endDate !== undefined && setEndDate(result.endDate)\n    },\n    [startDate, endDate]\n  )\n\n  const handleApply = useCallback(() => {\n    setShowPicker(false)\n\n    if (startDate && endDate) {\n      onChange({\n        start: dayjs(startDate)\n          .startOf('day')\n          .toDate(),\n        end: dayjs(endDate)\n          .endOf('day')\n          .toDate(),\n      })\n    }\n  }, [endDate, onChange, startDate])\n\n  const handleClear = useCallback(() => {\n    setStartDate(null)\n    setEndDate(null)\n    setShowPicker(false)\n    onChange({ start: null, end: null })\n  }, [onChange])\n\n  const labelProps = useMemo(() => {\n    const _startDate = showPicker ? startDate : startDateProp\n    const _endDate = showPicker ? endDate : endDateProp\n    return {\n      startText: _startDate ? dayjs(_startDate).format(format) : START_DATE,\n      endText: _endDate ? dayjs(_endDate).format(format) : END_DATE,\n    }\n  }, [endDate, endDateProp, format, showPicker, startDate, startDateProp])\n\n  const compactMode = useViewport().below('medium')\n\n  const displayMonthBeforeOnLeft = useMemo(() => {\n    // If both dates are in the same month, use the right calendar\n    // for it, and display month before on the left calendar.\n    const propsDatesInSameMonth =\n      startDateProp &&\n      endDateProp &&\n      dayjs(startDateProp).isSame(dayjs(endDateProp), 'month')\n\n    return !compactMode && (propsDatesInSameMonth || !startDateProp)\n  }, [compactMode, endDateProp, startDateProp])\n\n  return (\n    <div>\n      <Labels\n        ref={labelsRef}\n        enabled={showPicker}\n        hasSetDates={Boolean(startDateProp && endDateProp)}\n        onClick={handleLabelsClick}\n        {...labelProps}\n      />\n      <Popover\n        closeOnOpenerFocus\n        onClose={handlePopoverClose}\n        opener={labelsRef.current}\n        placement=\"bottom-start\"\n        visible={showPicker}\n        css={`\n          min-width: ${37.5 * GU + 2}px;\n          border: 0;\n          filter: none;\n          background: none;\n          margin: 2px 0 0 0;\n        `}\n      >\n        <div\n          css={`\n            padding: ${2.5 * GU}px ${3 * GU}px ${3 * GU}px;\n            border: 1px solid ${theme.border};\n            border-radius: ${BIG_RADIUS}px;\n            background: ${theme.surface};\n          `}\n        >\n          <div\n            css={`\n              display: flex;\n              flex-direction: row;\n              align-items: baseline;\n            `}\n          >\n            <DatePicker\n              datesRangeEnd={endDate}\n              datesRangeStart={startDate}\n              initialDate={dayjs(startDateProp || undefined)\n                .subtract(displayMonthBeforeOnLeft ? 1 : 0, 'month')\n                .toDate()}\n              onSelect={handleDateClick}\n            />\n            {!compactMode && (\n              <DatePicker\n                datesRangeEnd={endDate}\n                datesRangeStart={startDate}\n                initialDate={dayjs(endDateProp || undefined).toDate()}\n                onSelect={handleDateClick}\n                css={`\n                  margin-left: ${1 * GU}px;\n                `}\n              />\n            )}\n          </div>\n\n          <div\n            css={`\n              display: flex;\n              align-items: center;\n              justify-content: space-between;\n              margin-top: ${GU * 2.25}px;\n\n              ${compactMode\n                ? ''\n                : `\n                    max-width: 247px;\n                    margin-left: auto;\n                  `};\n            `}\n          >\n            <Button onClick={handleClear} size=\"small\" wide>\n              Reset\n            </Button>\n            <Button\n              disabled={!startDate || !endDate}\n              mode=\"strong\"\n              onClick={handleApply}\n              size=\"small\"\n              wide\n              css={`\n                margin-left: ${1.5 * GU}px;\n              `}\n            >\n              Apply\n            </Button>\n          </div>\n        </div>\n      </Popover>\n    </div>\n  )\n}\n\nDateRangePicker.propTypes = {\n  endDate: PropTypes.instanceOf(Date),\n  format: PropTypes.string,\n  onChange: PropTypes.func,\n  startDate: PropTypes.instanceOf(Date),\n}\n\nDateRangePicker.defaultProps = {\n  format: 'MM/DD/YYYY',\n  onChange: () => {},\n}\n\nexport default DateRangePicker\n"],"names":["DateRangePicker","format","endDate","endDateProp","onChange","startDate","startDateProp","theme","useTheme","labelsRef","useRef","showPicker","setShowPicker","useState","setStartDate","setEndDate","useEffect","handlePopoverClose","useCallback","handleLabelsClick","show","handleDateClick","date","result","handleDateSelect","undefined","handleApply","start","dayjs","startOf","toDate","end","endOf","handleClear","labelProps","useMemo","_startDate","_endDate","startText","START_DATE","endText","END_DATE","compactMode","useViewport","below","displayMonthBeforeOnLeft","propsDatesInSameMonth","isSame","React","Labels","_extends","Boolean","current","GU","border","surface","DatePicker","subtract","Button","propTypes","PropTypes","instanceOf","Date","string","func","defaultProps","BIG_RADIUS"],"mappings":"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"}