{"version":3,"file":"TabBarLegacy.js","sources":["../src/components/Tabs/TabBarLegacy.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { useTheme } from '../../theme'\nimport { font, unselectable, noop } from '../../utils'\n\nclass TabBar extends React.Component {\n  static propTypes = {\n    items: PropTypes.arrayOf(PropTypes.node).isRequired,\n    selected: PropTypes.number,\n    onChange: PropTypes.func,\n    inAppBar: PropTypes.bool,\n  }\n  static defaultProps = {\n    selected: 0,\n    onChange: noop,\n  }\n\n  state = {\n    displayFocusRing: false,\n  }\n\n  _barRef = React.createRef()\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown)\n  }\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown)\n  }\n\n  enableFocusRing() {\n    this.setState({ displayFocusRing: true })\n  }\n  disableFocusRing() {\n    this.setState({ displayFocusRing: false })\n  }\n  selectElement(element) {\n    const { onChange } = this.props\n    if (!element || !this._barRef.current) {\n      return\n    }\n    const index = [...this._barRef.current.childNodes].indexOf(element)\n    if (index === -1) {\n      return\n    }\n\n    onChange(index)\n  }\n  handleMouseDown = () => {\n    this.disableFocusRing()\n  }\n  handleKeydown = ({ key }) => {\n    if (key === 'Enter') {\n      this.selectElement(document.activeElement)\n      this.enableFocusRing()\n    }\n    if (key === 'Tab') {\n      this.enableFocusRing()\n    }\n  }\n  handleTabMouseDown = ({ currentTarget }) => {\n    // We would usually avoid using the DOM when possible, and prefer using a\n    // separate component (`Tab`) to keep the `index` in a prop, then pass it\n    // using an event prop. But since `this.selectElement()` is needed (so we\n    // can pass `document.activeElement` to it for the keyboard), and we have\n    // `e.currentTarget` in the event object, we might as well use it for the\n    // pointer device too.\n    this.selectElement(currentTarget)\n  }\n  render() {\n    const { displayFocusRing } = this.state\n    const { items, selected, inAppBar } = this.props\n    return (\n      <nav onMouseDown={this.handleMouseDown}>\n        <Bar ref={this._barRef} border={!inAppBar}>\n          {items.map((item, i) => (\n            <Tab\n              key={i}\n              tabIndex=\"0\"\n              selected={i === selected}\n              focusRing={displayFocusRing}\n              onMouseDown={this.handleTabMouseDown}\n            >\n              <Label selected={i === selected}>{item}</Label>\n              {displayFocusRing && <FocusRing />}\n            </Tab>\n          ))}\n        </Bar>\n      </nav>\n    )\n  }\n}\n\n/* eslint-disable react/prop-types */\n\nfunction Bar({ children, border }) {\n  const theme = useTheme()\n  return (\n    <ul\n      css={`\n        display: flex;\n        border-bottom: ${border ? `1px solid ${theme.border}` : '0'};\n      `}\n    >\n      {children}\n    </ul>\n  )\n}\n\nfunction FocusRing({ children }) {\n  const theme = useTheme()\n  return (\n    <span\n      className=\"TabBarLegacy-FocusRing\"\n      css={`\n        display: none;\n        position: absolute;\n        top: -5px;\n        left: -5px;\n        right: -5px;\n        bottom: -5px;\n        border: 2px solid ${theme.accent};\n        border-radius: 2px;\n      `}\n    >\n      {children}\n    </span>\n  )\n}\n\nfunction Tab({ children, selected }) {\n  return (\n    <li\n      css={`\n        position: relative;\n        list-style: none;\n        padding: 0 30px;\n        cursor: pointer;\n        ${font({\n          weight: selected ? 'bold' : 'normal',\n          deprecationNotice: false,\n        })};\n        ${unselectable()};\n        &:focus {\n          outline: 0;\n          .TabBarLegacy-FocusRing {\n            display: block;\n          }\n        }\n      `}\n    >\n      {children}\n    </li>\n  )\n}\n\nfunction Label({ children, selected }) {\n  const theme = useTheme()\n  return (\n    <span\n      css={`\n        display: flex;\n        margin-bottom: -1px;\n        padding: 5px 0 3px;\n        border-bottom: 4px solid ${selected ? theme.accent : 'transparent'};\n      `}\n    >\n      {children}\n    </span>\n  )\n}\n\nexport default TabBar\n"],"names":["TabBar","React","Component","_defineProperty","displayFocusRing","createRef","disableFocusRing","key","selectElement","document","activeElement","enableFocusRing","currentTarget","componentDidMount","addEventListener","handleKeydown","componentWillUnmount","removeEventListener","setState","element","onChange","props","_barRef","current","index","childNodes","indexOf","render","state","items","selected","inAppBar","handleMouseDown","map","item","i","handleTabMouseDown","PropTypes","arrayOf","node","isRequired","number","func","bool","noop","Bar","children","border","theme","useTheme","FocusRing","accent","Tab","font","weight","deprecationNotice","unselectable","Label"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAKA,MAAMA,MAAN,SAAqBC,yBAAK,CAACC,SAA3B,CAAqC;AAAA,EAAA,WAAA,GAAA;AAAA,IAAA,KAAA,CAAA,GAAA,SAAA,CAAA,CAAA;;AAAA,IAY3BC,8BAAA,CAAA,IAAA,EAAA,OAAA,EAAA;AACNC,MAAAA,gBAAgB,EAAE,KAAA;AADZ,KAZ2B,CAAA,CAAA;;AAAA,IAgBzBH,8BAAAA,CAAAA,IAAAA,EAAAA,SAAAA,eAAAA,yBAAK,CAACI,SAAN,EAhByB,CAAA,CAAA;;AAAA,IAAAF,8BAAA,CAAA,IAAA,EAAA,iBAAA,EA2CjB,MAAM;AACtB,MAAA,IAAA,CAAKG,gBAAL,EAAA,CAAA;AACD,KA7CkC,CAAA,CAAA;;AAAA,IAAAH,8BAAA,CAAA,IAAA,EAAA,eAAA,EA8CnB,IAAa,IAAA;AAAA,MAAZ,IAAA;AAAEI,QAAAA,GAAAA;AAAF,OAAY,GAAA,IAAA,CAAA;;AAC3B,MAAIA,IAAAA,GAAG,KAAK,OAAZ,EAAqB;AACnB,QAAA,IAAA,CAAKC,aAAL,CAAmBC,QAAQ,CAACC,aAA5B,CAAA,CAAA;AACA,QAAA,IAAA,CAAKC,eAAL,EAAA,CAAA;AACD,OAAA;;AACD,MAAIJ,IAAAA,GAAG,KAAK,KAAZ,EAAmB;AACjB,QAAA,IAAA,CAAKI,eAAL,EAAA,CAAA;AACD,OAAA;AACF,KAtDkC,CAAA,CAAA;;AAAA,IAAAR,8BAAA,CAAA,IAAA,EAAA,oBAAA,EAuDd,KAAuB,IAAA;AAAA,MAAtB,IAAA;AAAES,QAAAA,aAAAA;AAAF,OAAsB,GAAA,KAAA,CAAA;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,MAAKJ,IAAAA,CAAAA,aAAL,CAAmBI,aAAnB,CAAA,CAAA;AACD,KA/DkC,CAAA,CAAA;AAAA,GAAA;;AAkBnCC,EAAAA,iBAAiB,GAAG;AAClBJ,IAAAA,QAAQ,CAACK,gBAAT,CAA0B,SAA1B,EAAqC,KAAKC,aAA1C,CAAA,CAAA;AACD,GAAA;;AACDC,EAAAA,oBAAoB,GAAG;AACrBP,IAAAA,QAAQ,CAACQ,mBAAT,CAA6B,SAA7B,EAAwC,KAAKF,aAA7C,CAAA,CAAA;AACD,GAAA;;AAEDJ,EAAAA,eAAe,GAAG;AAChB,IAAA,IAAA,CAAKO,QAAL,CAAc;AAAEd,MAAAA,gBAAgB,EAAE,IAAA;AAApB,KAAd,CAAA,CAAA;AACD,GAAA;;AACDE,EAAAA,gBAAgB,GAAG;AACjB,IAAA,IAAA,CAAKY,QAAL,CAAc;AAAEd,MAAAA,gBAAgB,EAAE,KAAA;AAApB,KAAd,CAAA,CAAA;AACD,GAAA;;AACDI,EAAAA,aAAa,CAACW,OAAD,EAAU;AACrB,IAAM,MAAA;AAAEC,MAAAA,QAAAA;AAAF,KAAA,GAAe,KAAKC,KAA1B,CAAA;;AACA,IAAI,IAAA,CAACF,OAAD,IAAY,CAAC,KAAKG,OAAL,CAAaC,OAA9B,EAAuC;AACrC,MAAA,OAAA;AACD,KAAA;;AACD,IAAA,MAAMC,KAAK,GAAG,CAAC,GAAG,KAAKF,OAAL,CAAaC,OAAb,CAAqBE,UAAzB,CAAA,CAAqCC,OAArC,CAA6CP,OAA7C,CAAd,CAAA;;AACA,IAAA,IAAIK,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChB,MAAA,OAAA;AACD,KAAA;;AAEDJ,IAAAA,QAAQ,CAACI,KAAD,CAAR,CAAA;AACD,GAAA;;AAsBDG,EAAAA,MAAM,GAAG;AACP,IAAM,MAAA;AAAEvB,MAAAA,gBAAAA;AAAF,KAAA,GAAuB,KAAKwB,KAAlC,CAAA;AACA,IAAM,MAAA;AAAEC,MAAAA,KAAF;AAASC,MAAAA,QAAT;AAAmBC,MAAAA,QAAAA;AAAnB,KAAA,GAAgC,KAAKV,KAA3C,CAAA;AACA,IACE,oBAAApB,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,MAAA,WAAW,EAAE,IAAK+B,CAAAA,eAAAA;AAAvB,KAAA,eACE/B,wCAAC,GAAD,EAAA;AAAK,MAAA,GAAG,EAAE,IAAA,CAAKqB,OAAf;AAAwB,MAAA,MAAM,EAAE,CAACS,QAAAA;AAAjC,KACGF,EAAAA,KAAK,CAACI,GAAN,CAAU,CAACC,IAAD,EAAOC,CAAP,kBACTlC,yBAAA,CAAA,aAAA,CAAC,GAAD,EAAA;AACE,MAAA,GAAG,EAAEkC,CADP;AAEE,MAAA,QAAQ,EAAC,GAFX;AAGE,MAAA,QAAQ,EAAEA,CAAC,KAAKL,QAHlB;AAIE,MAAA,SAAS,EAAE1B,gBAJb;AAKE,MAAA,WAAW,EAAE,IAAKgC,CAAAA,kBAAAA;AALpB,KAAA,eAOEnC,wCAAC,KAAD,EAAA;AAAO,MAAA,QAAQ,EAAEkC,CAAC,KAAKL,QAAAA;AAAvB,KAAkCI,EAAAA,IAAlC,CAPF,EAQG9B,gBAAgB,iBAAIH,yBAAC,CAAA,aAAA,CAAA,SAAD,EARvB,IAAA,CAAA,CADD,CADH,CADF,CADF,CAAA;AAkBD,GAAA;;AArFkC,CAAA;AAwFrC;;;AAxFMD,8BAAAA,CAAAA,QACe,WAAA,EAAA;AACjB6B,EAAAA,KAAK,EAAEQ,eAAS,CAACC,OAAV,CAAkBD,eAAS,CAACE,IAA5B,CAAA,CAAkCC,UADxB;AAEjBV,EAAAA,QAAQ,EAAEO,eAAS,CAACI,MAFH;AAGjBrB,EAAAA,QAAQ,EAAEiB,eAAS,CAACK,IAHH;AAIjBX,EAAAA,QAAQ,EAAEM,eAAS,CAACM,IAAAA;AAJH;;AADf3C,8BAAAA,CAAAA,QAOkB,cAAA,EAAA;AACpB8B,EAAAA,QAAQ,EAAE,CADU;AAEpBV,EAAAA,QAAQ,EAAEwB,kBAAAA;AAFU;;AAmFxB,SAASC,GAAT,CAAmC,KAAA,EAAA;AAAA,EAAtB,IAAA;AAAEC,IAAAA,QAAF;AAAYC,IAAAA,MAAAA;AAAZ,GAAsB,GAAA,KAAA,CAAA;AACjC,EAAMC,MAAAA,KAAK,GAAGC,cAAQ,EAAtB,CAAA;AACA,EACE,oBAAAhD,yBAAA,CAAA,aAAA,CAAA,SAAA,EAAA;AAAA,IAAA,KAAA,EAGqB8C,MAAM,GAAI,CAAA,UAAA,EAAYC,KAAK,CAACD,MAAO,EAA7B,GAAiC,GAAA;AAH5D,GAAA,EAMGD,QANH,CADF,CAAA;AAUD,CAAA;;AAED,SAASI,SAAT,CAAiC,KAAA,EAAA;AAAA,EAAd,IAAA;AAAEJ,IAAAA,QAAAA;AAAF,GAAc,GAAA,KAAA,CAAA;AAC/B,EAAME,MAAAA,KAAK,GAAGC,cAAQ,EAAtB,CAAA;AACA,EACE,oBAAAhD,yBAAA,CAAA,aAAA,CAAA,WAAA,EAAA;AACE,IAAA,SAAS,EAAC,wBADZ;AAAA,IAAA,MAAA,EASwB+C,KAAK,CAACG,MAAAA;AAT9B,GAAA,EAaGL,QAbH,CADF,CAAA;AAiBD,CAAA;;AAED,SAASM,GAAT,CAAqC,KAAA,EAAA;AAAA,EAAxB,IAAA;AAAEN,IAAAA,QAAF;AAAYhB,IAAAA,QAAAA;AAAZ,GAAwB,GAAA,KAAA,CAAA;AACnC,EACE,oBAAA7B,yBAAA,CAAA,aAAA,CAAA,SAAA,EAAA;AAAA,IAAA,MAAA,EAMMoD,SAAI,CAAC;AACLC,MAAAA,MAAM,EAAExB,QAAQ,GAAG,MAAH,GAAY,QADvB;AAELyB,MAAAA,iBAAiB,EAAE,KAAA;AAFd,KAAD,CANV;AAAA,IAAA,MAAA,EAUMC,gBAAY,EAAA;AAVlB,GAAA,EAmBGV,QAnBH,CADF,CAAA;AAuBD,CAAA;;AAED,SAASW,KAAT,CAAuC,KAAA,EAAA;AAAA,EAAxB,IAAA;AAAEX,IAAAA,QAAF;AAAYhB,IAAAA,QAAAA;AAAZ,GAAwB,GAAA,KAAA,CAAA;AACrC,EAAMkB,MAAAA,KAAK,GAAGC,cAAQ,EAAtB,CAAA;AACA,EACE,oBAAAhD,yBAAA,CAAA,aAAA,CAAA,YAAA,EAAA;AAAA,IAAA,MAAA,EAK+B6B,QAAQ,GAAGkB,KAAK,CAACG,MAAT,GAAkB,aAAA;AALzD,GAAA,EAQGL,QARH,CADF,CAAA;AAYD,CAAA;;;;;;;;;;;;;;;;;;;;;;;;"}